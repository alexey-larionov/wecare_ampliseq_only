myColourScale <- scale_colour_manual(values=myColours)
# Static plot
ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=group, shape=ampliseq_nfe_only_outliers)) +
labs(title="PC1 vs PC2", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
# Static plot
ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=group, shape=ampliseq_only_outliers)) +
labs(title="PC1 vs PC2", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
# Interactive plot
plotly_group <- factor(eigenphen_ampliseq_kgen.df$group,
levels=c("AFR","AMR","EAS","SAS","EUR","WECARE"))
# Interactive plot
plotly_group <- factor(eigenphen_ampliseq_kgen.df$group,
levels=c("AFR","AMR","EAS","SAS","EUR","UBC","CBC"))
g <- ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=plotly_group, shape=ampliseq_nfe_only_outliers, text=sample)) +
labs(title="PC1 vs PC2 (manual thresholds)", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
g <- ggplot(eigenphen_ampliseq_kgen.df, aes(PC1,PC2)) +
geom_point(aes(col=plotly_group, shape=ampliseq_only_outliers, text=sample)) +
labs(title="PC1 vs PC2 (manual thresholds)", x="PC1", y="PC2") +
scale_shape_manual(values=c(16,4)) +
geom_vline(xintercept=pc1_th, linetype="dashed", size=0.5) +
geom_hline(yintercept=pc2_th, linetype="dashed", size=0.5) +
myColourScale
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(myColours, myColourScale, plotly_group, g)
joined_pca_outlier <- phenotypes.df$long_ids %in% joined_outliers
phenotypes.df <- data.frame(phenotypes.df, joined_pca_outlier)
rm(eigenphen_ampliseq_kgen.df, ampliseq_only_outliers,
joined_outliers, joined_pca_outlier, pc1_th, pc2_th)
sum(phenotypes.df$joined_pca_outlier)
sum(phenotypes.df$pc_outlier)
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
load(paste(base_folder, "s01_add_PCs.RData", sep="/"))
source_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s12_joined_ampliseq_1kgp_PCA/s06_explore_joined_PCA_plots"
load(paste(source_folder, "s01_joined_PCA_plots_622_3019_not_rare_not_in_LD.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
# Clean-up
rm(source_folder)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
# Threshold for outlier detection
th <- 3 # mean +/- (th*sd)
# Sequencing data (for wecare phenotypes: case/control status)
source_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s11_remove_BRCA_PALB_carriers"
load(paste(source_folder, "s01_exclude_BRCA1_BCRA2_PALB2_carriers.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
# Eigenvectors & eigenvalues
source_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s02_calculate_ampliseq_only_PCs/data/s04_pca"
eigenvectors_file <- paste(source_folder, "ampliseq_only_468_515_100PCs.eigenvec", sep="/")
eigenvalues_file <- paste(source_folder, "ampliseq_only_468_515_100PCs.eigenval", sep="/")
eigenvectors.df <- read.table(eigenvectors_file, header=T, sep="\t",quote="")
eigenvalues.df <- read.table(eigenvalues_file, header=F, sep="\t",quote="")
# Clean-up
rm(source_folder, eigenvectors_file, eigenvalues_file)
# Chunk 4: start_check
# List of objects
ls()
# Dimentions of objects
dim(eigenvectors.df)
dim(eigenvalues.df)
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
# Counts of nfe/controls/cases
table(phenotypes.df$cc)
# Update eigenvectors
rownames(eigenvectors.df) <- eigenvectors.df$FID
eigenvectors.df <- eigenvectors.df[,-1]
"long_ids" -> colnames(eigenvectors.df)[1]
eigenvectors.df[1:5,1:5]
# Chunk 5: eigenvalues
plot(eigenvalues.df$V1, type="b",
xlab="Eigenvector", ylab="Eigenvalue",
ylim=c(0,20),main="Top 100 eigenvectors")
plot(eigenvalues.df$V1[1:20], type="b",
xlab="Eigenvector", ylab="Eigenvalue",
ylim=c(0,20), main="Top 20 eigenvectors")
rm(eigenvalues.df)
# Chunk 6: prepare_data
# Add factor column with verbal lables for phenotypes to be used in plot
group <- factor(phenotypes.df$cc, levels = c(0,1), labels = c("UBC","CBC"))
phenotypes.df <- data.frame(phenotypes.df,group)
table(phenotypes.df$group)
# Add 5 top eigenvectors to phenotypes
phenotypes.df <- full_join(phenotypes.df,eigenvectors.df[,1:6], by="long_ids")
rownames(phenotypes.df) <- phenotypes.df$long_ids
# Prepare colour scale for ggplots
myColours <- c("UBC"="blue", "CBC"="red")
myColourScale <- scale_colour_manual(values=myColours)
# Clean-up
rm(group, eigenvectors.df, myColours)
# Chunk 7: calculate_thresholds
pc1_mean <- mean(phenotypes.df$PC1)
pc1_sd <- sd(phenotypes.df$PC1)
pc1_min <- pc1_mean - pc1_sd * th
pc1_max <- pc1_mean + pc1_sd * th
pc2_mean <- mean(phenotypes.df$PC2)
pc2_sd <- sd(phenotypes.df$PC2)
pc2_min <- pc2_mean - pc2_sd * th
pc2_max <- pc2_mean + pc2_sd * th
pc3_mean <- mean(phenotypes.df$PC3)
pc3_sd <- sd(phenotypes.df$PC3)
pc3_min <- pc3_mean - pc3_sd * th
pc3_max <- pc3_mean + pc3_sd * th
pc4_mean <- mean(phenotypes.df$PC4)
pc4_sd <- sd(phenotypes.df$PC4)
pc4_min <- pc4_mean - pc4_sd * th
pc4_max <- pc4_mean + pc4_sd * th
pc5_mean <- mean(phenotypes.df$PC5)
pc5_sd <- sd(phenotypes.df$PC5)
pc5_min <- pc5_mean - pc5_sd * th
pc5_max <- pc5_mean + pc5_sd * th
rm(pc1_mean, pc1_sd,
pc2_mean, pc2_sd,
pc3_mean, pc3_sd,
pc4_mean, pc4_sd,
pc5_mean, pc5_sd,
th)
# Chunk 8: mark_outliers
# Detect outliers on each PC
pc1_outlier <- phenotypes.df$PC1 < pc1_min | phenotypes.df$PC1 > pc1_max
pc2_outlier <- phenotypes.df$PC2 < pc2_min | phenotypes.df$PC2 > pc2_max
pc3_outlier <- phenotypes.df$PC3 < pc3_min | phenotypes.df$PC3 > pc3_max
pc4_outlier <- phenotypes.df$PC4 < pc4_min | phenotypes.df$PC4 > pc4_max
pc5_outlier <- phenotypes.df$PC5 < pc5_min | phenotypes.df$PC5 > pc5_max
# Detect outliers on any PC
pc_outlier <- pc1_outlier | pc2_outlier
#pc_outlier <- pc1_outlier | pc2_outlier | pc3_outlier | pc4_outlier | pc5_outlier
# Check counts of outliers
sum(pc1_outlier)
sum(pc2_outlier)
sum(pc3_outlier)
sum(pc4_outlier)
sum(pc5_outlier)
sum(pc_outlier)
# Add outliers data to phenotypes dataframe
phenotypes.df <- data.frame(phenotypes.df, pc_outlier, pc1_outlier, pc2_outlier,
pc3_outlier, pc4_outlier, pc5_outlier)
phenotypes.df %>%
filter(pc_outlier) %>%
select(Sample_num, pc_outlier, pc1_outlier, pc2_outlier,
pc3_outlier, pc4_outlier, pc5_outlier) %>%
arrange(as.integer(Sample_num))
# Clean-up
rm(pc_outlier, pc1_outlier, pc2_outlier, pc3_outlier, pc4_outlier, pc5_outlier)
# Chunk 9: pc1_pc2
# Prepare ggplot
g <- ggplot(phenotypes.df, aes(PC1,PC2)) +
geom_point(aes(col=group, text=Sample_num)) +
labs(title="PC1 vs PC2", x="PC1", y="PC2") +
theme(legend.title=element_blank()) + # To suppress the legend title
myColourScale +                       # otherwise it would be "group"
geom_vline(xintercept=c(pc1_min, pc1_max), linetype="dotted", size=0.2) +
geom_hline(yintercept=c(pc2_min, pc2_max), linetype="dotted", size=0.2)
# Draw static ggplot
#g
# Draw dynamic ggplotly
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(g)
# Chunk 10: pc2_pc3
# Prepare ggplot
g <- ggplot(phenotypes.df, aes(PC2,PC3)) +
geom_point(aes(col=group, text=Sample_num)) +
labs(title="PC2 vs PC3", x="PC2", y="PC3") +
theme(legend.title=element_blank()) +
myColourScale +
geom_vline(xintercept=c(pc2_min, pc2_max), linetype="dotted", size=0.2)
# geom_hline(yintercept=c(pc3_min, pc3_max), linetype="dotted", size=0.2)
# Draw static ggplot
#g
# Draw dynamic ggplotly
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(g)
# Chunk 11: pc3_pc4
# Prepare ggplot
g <- ggplot(phenotypes.df, aes(PC3,PC4)) +
geom_point(aes(col=group, text=Sample_num)) +
labs(title="PC3 vs PC4", x="PC3", y="PC4") +
theme(legend.title=element_blank()) +
myColourScale
#  geom_vline(xintercept=c(pc3_min, pc3_max), linetype="dotted", size=0.2) +
#  geom_hline(yintercept=c(pc4_min, pc4_max), linetype="dotted", size=0.2)
# Draw static ggplot
#g
# Draw dynamic ggplotly
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(g)
# Chunk 12: pc4_pc5
# Prepare ggplot
g <- ggplot(phenotypes.df, aes(PC4,PC5)) +
geom_point(aes(col=group, text=Sample_num)) +
labs(title="PC4 vs PC5", x="PC4", y="PC5") +
theme(legend.title=element_blank()) +
myColourScale
#  geom_vline(xintercept=c(pc4_min, pc4_max), linetype="dotted", size=0.2) +
#  geom_hline(yintercept=c(pc5_min, pc5_max), linetype="dotted", size=0.2)
# Draw static ggplot
#g
# Draw dynamic ggplotly
ggplotly(g, tooltip="text") # By default the tooltip would also show coordinates
# Clean-up
rm(g, myColourScale,
pc1_min, pc1_max, pc2_min, pc2_max, pc3_min, pc3_max, pc4_min, pc4_max, pc5_min, pc5_max)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s01_add_PCs.RData", sep="/"))
source_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s12_joined_ampliseq_1kgp_PCA/s06_explore_joined_PCA_plots"
load(paste(source_folder, "s01_joined_PCA_plots_622_3019_not_rare_not_in_LD.RData", sep="/"))
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
# Clean-up
rm(source_folder)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
library(ggplot2)
library(plotly)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
source_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s12_joined_ampliseq_1kgp_PCA/s06_explore_joined_PCA_plots"
load(paste(source_folder, "s01_joined_PCA_plots_622_3019_not_rare_not_in_LD.RData", sep="/"))
515-34
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,1:31]
colnames(phenotypes.df)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,c(1:31,37)]
colnames(phenotypes.df)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
table(phenotypes.df$cc)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: remove_outliers
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,c(1:31,37)]
colnames(phenotypes.df)
# Check remaining UBC and CBC
table(phenotypes.df$cc)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 1: set_width
#eval=F
options(width = 999)
# https://stackoverflow.com/questions/36845178/width-of-r-code-chunk-output-in-rmarkdown-files-knitr-ed-to-html
# Chunk 2: start_section
Sys.time()
rm(list=ls())
graphics.off()
library(knitr)
library(dplyr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v05_ampliseq_only/s13_ampliseq_only_PCA/s03_explore_PCA_plots_exclude_outliers"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F)
options(warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
#options(error = browser()) # Type Q or c to exit, drop browser level
# https://support.rstudio.com/hc/en-us/articles/200713843?version=1.1.456&mode=desktop
# https://stackoverflow.com/questions/13052522/how-to-leave-the-r-browser-mode-in-the-console-window/13052588
# Chunk 3: read_data
load(paste(base_folder, "s02_explore_ethnicity_of_outliers.RData", sep="/"))
# Chunk 4
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
# Chunk 5: remove_outliers
# Remove outliers
phenotypes.df <- phenotypes.df[!phenotypes.df$joined_pca_outlier,]
# Remove unnecessary columns
colnames(phenotypes.df)
phenotypes.df <- phenotypes.df[,c(1:31,37)]
colnames(phenotypes.df)
# Syncronise genotypes
genotypes.mx <- genotypes.mx[,rownames(phenotypes.df)]
# Check result
dim(genotypes.mx)
dim(phenotypes.df)
table(phenotypes.df$cc)
# Function to detect uniform vectors (expects vectors containing 0,1,2 or NA only)
uniform.udf <- function(x){
if(all(is.na(x))) return(TRUE) # Return T if all are NA
min(x,na.rm=T)==max(x,na.rm=T)} # Return T if min=max, otherwise return F
uniform_variants <- apply(genotypes.mx, 1, uniform.udf)
sum(uniform_variants)
genotypes.mx <- genotypes.mx[!uniform_variants,]
variants.df <- variants.df[!uniform_variants,]
dim(genotypes.mx)
dim(variants.df)
rm(uniform_variants, uniform.udf)
an.udf <- function(x){2*sum(!is.na(x))}
summary(as.factor(phenotypes.df$group))
total_AC <- apply(genotypes.mx, 1, sum, na.rm=T)
total_AN <- apply(genotypes.mx, 1, an.udf)
total_AF <- total_AC/total_AN
hist(total_AF, lab=T, ylim=c(0,1500))
hist(total_AF, lab=T, ylim=c(0,2500))
hist(total_AF, lab=T, ylim=c(0,3500))
hist(total_AF, lab=T, ylim=c(0,3000))
ubc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="UBC"]
dim(ubc_genotypes.mx)
ubc_AC <- apply(ubc_genotypes.mx, 1, sum, na.rm=T)
ubc_AN <- apply(ubc_genotypes.mx, 1, an.udf)
ubc_AF <- ubc_AC/ubc_AN
hist(ubc_AF, lab=T, ylim=c(0,1500))
hist(ubc_AF, lab=T, ylim=c(0,3000))
rm(ubc_genotypes.mx)
cbc_genotypes.mx <- genotypes.mx[,phenotypes.df$group=="CBC"]
dim(cbc_genotypes.mx)
cbc_AC <- apply(cbc_genotypes.mx, 1, sum, na.rm=T)
cbc_AN <- apply(cbc_genotypes.mx, 1, an.udf)
cbc_AF <- cbc_AC/cbc_AN
hist(cbc_AF, lab=T, ylim=c(0,3000))
rm(cbc_genotypes.mx, an.udf)
variants.df <- data.frame(variants.df,
total_AC, total_AN, total_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
colnames(variants.df)
rm(total_AC, total_AN, total_AF,
ubc_AC, ubc_AN, ubc_AF,
cbc_AC, cbc_AN, cbc_AF)
ls()
dim(genotypes.mx)
dim(phenotypes.df)
dim(variants.df)
sum(colnames(genotypes.mx) != rownames(phenotypes.df))
sum(rownames(genotypes.mx) != rownames(variants.df))
