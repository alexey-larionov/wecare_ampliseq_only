# Base folder
library(knitr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/check_mutiallelic/s07_filter_genotypes_and_variants"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F,
warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
# Load libraries
library(vcfR)
vcf_file <- paste(base_folder, "ampliseq_nfe_locID_MAflag.vcf", sep="/")
vcfr <- read.vcfR(vcf_file)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s07_filter_genotypes_and_variants/check_mutiallelic"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F,
warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
# Load libraries
library(vcfR)
vcf_file <- paste(base_folder, "ampliseq_nfe_locID_MAflag.vcf", sep="/")
vcfr <- read.vcfR(vcf_file)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s07_filter_genotypes_and_variants/check_multiallelic"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F,
warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
vcf_file <- paste(base_folder, "ampliseq_nfe_locID_MAflag.vcf", sep="/")
vcfr <- read.vcfR(vcf_file)
rm(vcf_file)
# Get data from header and fixed columns
meta_fix <- vcfR2tidy(vcfr, info_only=T)
# Get data frame with meta-information from vcf header
meta.df <- as.data.frame(meta_fix$meta)
dim(meta.df)
meta.df
# Get data frame with fixed columns (including parsed INFO, convert tibble to data-frame)
fixed.df <- as.data.frame(meta_fix$fix)
dim(fixed.df)
colnames(fixed.df)
fixed.df[1:5,1:7]
# Clean-up
rm(meta_fix, vcfr)
summary(as.factor(fixed.df$MultiAllelic))
x <- fixed.df[fixed.df$MultiAllelic,]
View(x)
x[1:5,c(1:9,13,20,25)]
rm(x)
# Chunk 1: set_width
options(width = 999)
# Chunk 2: start_section
# Time stamp
Sys.time()
# Clenan-up
rm(list=ls())
# Base folder
library(knitr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s07_filter_genotypes_and_variants/check_multiallelic"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F,
warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
# Load libraries
library(vcfR)
# Chunk 3: load_data
vcf_file <- paste(base_folder, "ampliseq_nfe_locID_MAflag_vqsr_hf.vcf", sep="/")
vcfr <- read.vcfR(vcf_file)
rm(vcf_file)
# Chunk 4: extract_meta_and_fixed
# Get data from header and fixed columns
meta_fix <- vcfR2tidy(vcfr, info_only=T)
# Get data frame with meta-information from vcf header
meta.df <- as.data.frame(meta_fix$meta)
dim(meta.df)
meta.df
# Get data frame with fixed columns (including parsed INFO, convert tibble to data-frame)
fixed.df <- as.data.frame(meta_fix$fix)
dim(fixed.df)
colnames(fixed.df)
fixed.df[1:5,1:7]
# Clean-up
rm(meta_fix, vcfr)
summary(as.factor(fixed.df$MultiAllelic))
x <- fixed.df[fixed.df$MultiAllelic,]
x[1:5,c(1:9,16,23,28)]
# Chunk 1: set_width
options(width = 999)
# Chunk 2: start_section
# Time stamp
Sys.time()
# Clenan-up
rm(list=ls())
# Base folder
library(knitr)
base_folder="/Users/alexey/Documents/wecare/ampliseq/v04_ampliseq_nfe/s07_filter_genotypes_and_variants/check_multiallelic"
opts_knit$set(root.dir = base_folder)
options(stringsAsFactors = F,
warnPartialMatchArgs = T,
warnPartialMatchAttr = T,
warnPartialMatchDollar = T)
# Load libraries
library(vcfR)
# Chunk 3: load_data
vcf_file <- paste(base_folder, "ampliseq_nfe_locID_MAflag_vqsr_hf_MAsplit.vcf", sep="/")
vcfr <- read.vcfR(vcf_file)
rm(vcf_file)
# Chunk 4: extract_meta_and_fixed
# Get data from header and fixed columns
meta_fix <- vcfR2tidy(vcfr, info_only=T)
# Get data frame with meta-information from vcf header
meta.df <- as.data.frame(meta_fix$meta)
dim(meta.df)
meta.df
# Get data frame with fixed columns (including parsed INFO, convert tibble to data-frame)
fixed.df <- as.data.frame(meta_fix$fix)
dim(fixed.df)
colnames(fixed.df)
fixed.df[1:5,1:7]
# Clean-up
rm(meta_fix, vcfr)
# Chunk 5
summary(as.factor(fixed.df$MultiAllelic))
selected_ma_locations <- c("Loc000000026","Loc000000027","Loc000000061","Loc000000085","Loc000000149")
sum(fixed.df$LocID %in% selected_ma_locations)
sum(is.na(fixed.df$MultiAllelic))
which(fixed.df$LocID == "Loc000000061")
which(fixed.df$LocID == "Loc000000060")
y <- fixed.df[60:64,]
View(y)
y <- fixed.df[60:66,]
?any
a <- c("A","A","A",NA)
all(a=="A")
all(a=="A",na.rm=T)
all(is.na(a))
any(is.na(a))
View(y)
fixed.df[60:66,c(1:9,16,23,28)]
